// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum ROLE {
  ADMIN
  USER
  MODERATOR
}

enum CategoriaEstoqueEnum {
  DEFENSIVOS
  FERTILIZANTES
  SEMENTES
  CONDICIONADORES
  FERRAMENTAS
  EQUIPAMENTOS
  EMBALAGENS
}

enum StatusEstoqueEnum {
  DISPONIVEL
  EM_USO
  ESGOTADO
  DANIFICADO
  EXPIRADO
}

enum UnidadeMedidaEnum {
  QUILO
  GRAMA
  LITRO
  METRO
  CENTIMETRO
  METRO_QUADRADO
  METRO_CUBICO
  TONELADA
}

enum TipoPlantaEnum {
  SOJA
  MILHO
  FEIJAO
}

enum TipoSoloEnum {
  ARENOSO         
  ARGILOSO        
  SILTOSO         
  MISTO           
  HUMIFERO        
  CALCARIO        
  GLEISSOLO       
  LATOSSOLO       
  CAMBISSOLO      
  ORGANOSSOLO     
  NEOSSOLO        
  PLANOSSOLO      
  VERTISSOLO      
}

model Usuario {
  id                   Int       @id @default(autoincrement())
  password             String    @db.VarChar(100)
  resetPasswordToken   String?
  resetPasswordExpires DateTime?
  role                 ROLE      @default(USER)
  email                String    @unique @db.VarChar(100)
  idPlano              Int?
  cpf                  String?   @unique @db.Char(11)
  name                 String    @db.VarChar(100)
  telefone             String?   @db.VarChar(14)
  ativo                Boolean   @default(true)
  createdBy            String?   @db.VarChar(255)
  dateCreated          DateTime  @default(now()) @db.Timestamp(0)
  dateModification     DateTime  @updatedAt @db.Timestamp(0)
  modifiedBy           String?   @db.VarChar(255)
  
  fazendas             Fazenda[] 
  fornecedores         Fornecedor[]
  pragas              Praga[]     
  cultivares          Cultivar[]  
}

model Fazenda {
  id                   Int       @id @default(autoincrement())
  nome                 String    @db.VarChar(255)
  latitude             Float
  longitude            Float
  areaTotal            Float? 
  cnpj                 String?   @unique @db.VarChar(14)
  soloPredominante     String?   @db.VarChar(255)
  cultivoPredominante  String?   @db.VarChar(255)
  municipio            String?   @db.VarChar(255)
  uf                   String?   @db.VarChar(2)
  idUsuario            Int
  ativo                Boolean   @default(true)
  createdBy            String?   @db.VarChar(255)
  dateCreated          DateTime  @default(now())
  dateModification     DateTime  @updatedAt
  modifiedBy           String?   @db.VarChar(255)

  usuario              Usuario   @relation(fields: [idUsuario], references: [id]) 
  produtosEstoque      produtosEstoque[]
}

model produtosEstoque {
  id                   Int       @id @default(autoincrement())
  descricao            String?
  marca                String?
  nome                 String?
  quantidade           Int       @default(0)
  valorUnitario        Float     @default(0.0)
  unidadeMedida        UnidadeMedidaEnum
  dataValidade         DateTime?
  categoria            CategoriaEstoqueEnum
  status               StatusEstoqueEnum
  idFazenda            Int
  idFornecedor         Int
  ativo                Boolean   @default(true)
  createdBy            String?   @db.VarChar(255)
  dateCreated          DateTime  @default(now())
  dateModification     DateTime  @updatedAt
  modifiedBy           String?   @db.VarChar(255)

  fazenda              Fazenda   @relation(fields: [idFazenda], references: [id])
  fornecedor     Fornecedor @relation(fields: [idFornecedor], references: [id])
}

model Fornecedor {
  id             Int               @id @default(autoincrement())
  cnpj           String            @unique @db.VarChar(14)
  razaoSocial    String
  nomeFantasia   String?
  responsavel    String?
  email          String?
  telefone       String?
  linkSite       String?
  logradouro     String?
  numero         String?
  complemento    String?
  bairro         String?
  cidade         String?
  estado         String?
  cep            String?
  idUsuario      Int
  ativo          Boolean           @default(true)
  createdBy      String?
  dateCreated    DateTime          @default(now())
  dateModification DateTime        @updatedAt
  modifiedBy     String?

  usuario         Usuario           @relation(fields: [idUsuario], references: [id])
  produtosEstoque produtosEstoque[]
  cultivares      Cultivar[]        

}

model Praga {
  id             Int       @id @default(autoincrement())
  nomeCientifico String    @db.VarChar(255)
  nomeComum      String    @db.VarChar(255)
  descricao      String?
  idUsuario      Int
  dateCreated    DateTime  @default(now())
  dateModification DateTime @updatedAt
  createdBy      String?
  modifiedBy     String?

  usuario        Usuario   @relation(fields: [idUsuario], references: [id])
  cultivares     Cultivar[] 

}

model Cultivar {
  id                    Int           @id @default(autoincrement())
  nomeCientifico        String        @db.VarChar(255)
  nomePopular           String        @db.VarChar(255)
  tipoPlanta            TipoPlantaEnum
  tipoSolo              TipoSoloEnum  
  phSolo                Float
  dataPlantioInicio     DateTime
  dataPlantioFim        DateTime
  periodoDias           Int
  mmAgua                Float
  aduboNitrogenio       Float
  aduboFosforo          Float
  aduboPotassio         Float
  tempoCicloDias        Int
  densidadePlantio      Float         
  densidadeColheita     Float         
  observacao            String?
  idUsuario             Int
  idPraga               Int?           
  idFornecedor          Int?
  createdBy             String?
  dateCreated           DateTime      @default(now())
  dateModification      DateTime      @updatedAt
  modifiedBy            String?

  usuario               Usuario       @relation(fields: [idUsuario], references: [id])
  praga                 Praga?        @relation(fields: [idPraga], references: [id])
  fornecedor            Fornecedor?   @relation(fields: [idFornecedor], references: [id])

}
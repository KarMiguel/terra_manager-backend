// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum ROLE {
  ADMIN
  USER
  MODERATOR
}

enum CategoriaEstoqueEnum {
  DEFENSIVOS
  FERTILIZANTES
  SEMENTES
  CONDICIONADORES
  FERRAMENTAS
  EQUIPAMENTOS
  EMBALAGENS
}

enum StatusEstoqueEnum {
  DISPONIVEL
  EM_USO
  ESGOTADO
  DANIFICADO
  EXPIRADO
}

enum UnidadeMedidaEnum {
  QUILO
  GRAMA
  LITRO
  METRO
  CENTIMETRO
  METRO_QUADRADO
  METRO_CUBICO
  TONELADA
}

enum TipoPlantaEnum {
  SOJA
  MILHO
  FEIJAO
}

enum TipoSoloEnum {
  ARENOSO         
  ARGILOSO        
  SILTOSO         
  MISTO           
  HUMIFERO        
  CALCARIO        
  GLEISSOLO       
  LATOSSOLO       
  CAMBISSOLO      
  ORGANOSSOLO     
  NEOSSOLO        
  PLANOSSOLO      
  VERTISSOLO      
}

model Usuario {
  id                   Int       @id @default(autoincrement())
  password             String    @db.VarChar(100)
  resetPasswordToken   String?   @map("reset_password_token")
  resetPasswordExpires DateTime? @map("reset_password_expires")
  role                 ROLE      @default(USER)
  email                String    @unique @db.VarChar(100)
  idPlano              Int?      @map("id_plano")
  cpf                  String?   @unique @db.Char(11)
  nome                 String    @db.VarChar(100)
  telefone             String?   @db.VarChar(14)
  ativo                Boolean   @default(true)
  createdBy            String?   @map("created_by") @db.VarChar(255)
  dateCreated          DateTime  @map("date_created") @default(now()) @db.Timestamp(0)
  dateModified         DateTime  @map("date_modified") @updatedAt @db.Timestamp(0)
  modifiedBy           String?   @map("modified_by") @db.VarChar(255)
  
  fazendas             Fazenda[] 
  fornecedores         Fornecedor[]
  cultivares           Cultivar[]  

  @@map("usuario")
}

model Fazenda {
  id                   Int       @id @default(autoincrement())
  nome                 String    @db.VarChar(255)
  latitude             Float
  longitude            Float
  areaTotal            Float?    @map("area_total")
  cnpj                 String?   @unique @db.VarChar(14)
  soloPredominante     String?   @map("solo_predominante") @db.VarChar(255)
  cultivoPredominante  String?   @map("cultivo_predominante") @db.VarChar(255)
  municipio            String?   @db.VarChar(255)
  uf                   String?   @db.VarChar(2)
  idUsuario            Int       @map("id_usuario")
  ativo                Boolean   @default(true)
  createdBy            String?   @map("created_by") @db.VarChar(255)
  dateCreated          DateTime  @map("date_created") @default(now())
  dateModified         DateTime  @map("date_modified") @updatedAt
  modifiedBy           String?   @map("modified_by") @db.VarChar(255)

  usuario              Usuario   @relation(fields: [idUsuario], references: [id]) 
  produtosEstoque      ProdutosEstoque[]

  @@map("fazenda")
}

model ProdutosEstoque {
  id                   Int       @id @default(autoincrement())
  descricao            String?
  marca                String?
  nome                 String?
  quantidade           Int       @default(0)
  valorUnitario        Float     @map("valor_unitario") @default(0.0)
  unidadeMedida        UnidadeMedidaEnum @map("unidade_medida")
  dataValidade         DateTime? @map("data_validade")
  categoria            CategoriaEstoqueEnum
  status               StatusEstoqueEnum
  idFazenda            Int       @map("id_fazenda")
  idFornecedor         Int       @map("id_fornecedor")
  ativo                Boolean   @default(true)
  createdBy            String?   @map("created_by") @db.VarChar(255)
  dateCreated          DateTime  @map("date_created") @default(now())
  dateModified         DateTime  @map("date_modified") @updatedAt
  modifiedBy           String?   @map("modified_by") @db.VarChar(255)

  fazenda              Fazenda   @relation(fields: [idFazenda], references: [id])
  fornecedor           Fornecedor @relation(fields: [idFornecedor], references: [id])

  @@map("produtos_estoque")
}

model Fornecedor {
  id                   Int               @id @default(autoincrement())
  cnpj                 String            @unique @db.VarChar(14)
  razaoSocial          String            @map("razao_social")
  nomeFantasia         String?           @map("nome_fantasia")
  responsavel          String?
  email                String?
  telefone             String?
  linkSite             String?           @map("link_site")
  logradouro           String?
  numero               String?
  complemento          String?
  bairro               String?
  cidade               String?
  estado               String?
  cep                  String?
  observacao           String?
  idUsuario            Int               @map("id_usuario")
  ativo                Boolean           @default(true)
  createdBy            String?           @map("created_by")
  dateCreated          DateTime          @map("date_created") @default(now())
  dateModified         DateTime          @map("date_modified") @updatedAt
  modifiedBy           String?           @map("modified_by")

  usuario              Usuario           @relation(fields: [idUsuario], references: [id])
  produtosEstoque      ProdutosEstoque[]
  cultivares           Cultivar[]        

  @@map("fornecedor")
}

model Praga {
  id                   Int       @id @default(autoincrement())
  nomeCientifico       String    @map("nome_cientifico") @db.VarChar(255)
  nomeComum            String    @map("nome_comum") @db.VarChar(255)
  descricao            String?
  dateCreated          DateTime  @map("date_created") @default(now())
  dateModified         DateTime  @map("date_modified") @updatedAt
  createdBy            String?   @map("created_by")
  modifiedBy           String?   @map("modified_by")

  cultivares           Cultivar[] 

  @@map("praga")
}

model Cultivar {
  id                    Int           @id @default(autoincrement())
  nomeCientifico        String        @map("nome_cientifico") @db.VarChar(255)
  nomePopular           String        @map("nome_popular") @db.VarChar(255)
  tipoPlanta            TipoPlantaEnum @map("tipo_planta")
  tipoSolo              TipoSoloEnum   @map("tipo_solo")
  phSolo                Float          @map("ph_solo")
  dataPlantioInicio     DateTime       @map("data_plantio_inicio")
  dataPlantioFim        DateTime       @map("data_plantio_fim")
  periodoDias           Int            @map("periodo_dias")
  mmAgua                Float          @map("mm_agua")
  aduboNitrogenio       Float          @map("adubo_nitrogenio")
  aduboFosforo          Float          @map("adubo_fosforo")
  aduboPotassio         Float          @map("adubo_potassio")
  tempoCicloDias        Int            @map("tempo_ciclo_dias")
  densidadePlantio      Float          @map("densidade_plantio")
  densidadeColheita     Float          @map("densidade_colheita")
  observacao            String?
  idUsuario             Int            @map("id_usuario")
  idPraga               Int?           @map("id_praga")
  idFornecedor          Int?           @map("id_fornecedor")
  createdBy             String?        @map("created_by")
  dateCreated           DateTime       @map("date_created") @default(now())
  dateModified          DateTime       @map("date_modified") @updatedAt
  modifiedBy            String?        @map("modified_by")

  usuario               Usuario       @relation(fields: [idUsuario], references: [id])
  praga                 Praga?        @relation(fields: [idPraga], references: [id])
  fornecedor            Fornecedor?   @relation(fields: [idFornecedor], references: [id])

  @@map("cultivar")
}